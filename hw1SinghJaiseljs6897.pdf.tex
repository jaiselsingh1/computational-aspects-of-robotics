\documentclass[11pt]{article}
\usepackage{geometry}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{enumitem}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{listings}
\usepackage{xcolor}

\geometry{margin=1in}

% Configure Python syntax highlighting
\lstset{
    language=Python,
    basicstyle=\ttfamily\small,
    keywordstyle=\color{blue},
    commentstyle=\color{green!60!black},
    stringstyle=\color{red},
    numbers=left,
    numberstyle=\tiny\color{gray},
    frame=single,
    breaklines=true,
    showstringspaces=false,
    tabsize=2,
    inputencoding=utf8,
    extendedchars=true,
    literate={Î¸}{{$\theta$}}1
}

\DeclareMathOperator{\atan}{atan}

\title{COMS W4733: Computational Aspects of Robotics\\Homework 1}
\author{Jaisel Singh \\ js6897}
\date{September 20, 2025}

\begin{document}
\maketitle

\section*{Problem 1: Homogeneous Transformations}

\subsection*{1. Convert to homogeneous coordinates (1 point)}
Convert $p_A^{\text{cart}} = \begin{bmatrix} 2 \\ 1 \\ 1 \end{bmatrix}$ to homogeneous:
\[
p_A = \begin{bmatrix} p_A^{\text{cart}} \\ 1 \end{bmatrix}
= \begin{bmatrix} 2 \\ 1 \\ 1 \\ 1 \end{bmatrix}.
\]

\subsection*{2. Construct $^{A}\!T_{B}$ (4 points)}
Rotation $90^\circ$ about $+z$:
\[
R = R_z(90^\circ) =
\begin{bmatrix}
0 & -1 & 0\\
1 & \phantom{-}0 & 0\\
0 & \phantom{-}0 & 1
\end{bmatrix},
\qquad
t = \begin{bmatrix} 1 \\ -2 \\ 0 \end{bmatrix}.
\]
Therefore
\[
^{A}\!T_{B}=\begin{bmatrix}R&t\\0~0~0&1\end{bmatrix}
=
\begin{bmatrix}
0 & -1 & 0 & 1\\
1 & \phantom{-}0 & 0 & -2\\
0 & \phantom{-}0 & 1 & 0\\
0 & \phantom{-}0 & 0 & 1
\end{bmatrix}.
\]

\subsection*{3. Transform the point (3 points)}
Use ${(^{A}\!T_{B})}^{-1}=\begin{bmatrix}R^\top&-R^\top t\\ 0&1\end{bmatrix}$:
\[
^{B}\!T_{A}=
\begin{bmatrix}
0 & 1 & 0 & 2\\
-1 & 0 & 0 & 1\\
0 & 0 & 1 & 0\\
0 & 0 & 0 & 1
\end{bmatrix},\qquad
p_B = {}^{B}\!T_{A}\,p_A =
\begin{bmatrix} 3\\ -1\\ 1\\ 1\end{bmatrix}.
\]
So $p_B^{\text{cart}}=(3,-1,1)^\top$.

\subsection*{4. Interpret the result (2 points)}
The $90^\circ$ rotation swaps $(x,y)\mapsto(-y,x)$; the translation adds $(+1,-2,0)$, yielding $(3,-1,1)$ as expected. $^{B}\!T_{A}$ is the inverse transformation, it first translates the point by $-t$ and then performs a $90^\circ$ \emph{clockwise} rotation about the z-axis. This explicitly works out to be:
$p_B = R^\top (p_A - t)$.

\section*{Problem 2: Configuration Space and Workspace (Mobile Robot)}

\subsection*{1. C-space and DOF (2 points)}
\noindent
(a) $q=(x,y,\theta)\in\mathbb{R}^2\times S^1$ with
\[
\mathcal{Q}=[0,5]\times[0,4]\times(-\pi,\pi].
\]
(b) $\mathrm{DOF}=3$ (two translational, one rotational).

\subsection*{2. Position workspace of $P$ (5 points)}
(a) Ignoring footprint:
\[
\mathcal{W}=[0,5]\times[0,4].
\]
(b) With disc footprint $r_R=0.35$:
\[
\mathcal{W}_{\text{clear}}=\{(x,y): 0.35 < x < 4.65,\ 0.35 < y < 3.65\}.
\]
(c) The point $(0.30,0.30)\notin\mathcal{W}_{\text{clear}}$ (collision).

\subsection*{3. Workspace $\to$ C-space Obstacles (2 points)}

\begin{enumerate}[label=(\alph*)]
    \item The C-space obstacle set is obtained by growing the obstacle radius by $r_R$:
    \[
    Q_{\text{obs}} = \{(x,y) \mid \|(x,y) - (0.9,0.3)\| \leq 0.10 + r_R\}
    = \{(x,y) \mid \|(x,y) - (0.9,0.3)\| \leq 0.45\}.
    \]

    This set does not depend on $\theta$ because the robot is a disc (isotropic).

    \item For $q^\star = (1.20,\,0.40,\,\theta=0.524)$, compute the distance:
    \[
    d = \|(1.20,\,0.40) - (0.9,\,0.3)\|
      = \sqrt{0.3^2 + 0.1^2}
      = 0.316 < 0.45.
    \]

    Hence, $q^\star \in Q_{\text{obs}}$ (the configuration is in collision).
\end{enumerate}



\subsection*{4. Connectivity (1 point)}
$\mathcal{Q}_{\text{free}}$ is \emph{path-connected} if any two configurations in it are connected by a continuous collision-free path. This means that every pair of collision-free configurations can be connected by a continuous collision free path. This property is essential for motion planning because it gurantees that a planner can find a path between any two configurations in $\mathcal{Q}_{\text{free}}$ if one exists.

\section*{Problem 3: Forward Kinematics (2R Planar Arm)}

\subsection*{1. Geometric FK for position \& orientation (4 points)}

\begin{enumerate}[label=(\alph*)]
\item Vector form:
\[
p_E =
\underbrace{R(\theta_1)\!\begin{bmatrix}L_1\\0\end{bmatrix}}_{\text{Link 1}}
+
\underbrace{R(\theta_1+\theta_2)\!\begin{bmatrix}L_2\\0\end{bmatrix}}_{\text{Link 2}},
\quad
R(\alpha)=\begin{bmatrix}\cos\alpha&-\sin\alpha\\ \sin\alpha&\cos\alpha\end{bmatrix}.
\]

\item Scalars:
\[
x=L_1\cos\theta_1+L_2\cos(\theta_1+\theta_2),\quad
y=L_1\sin\theta_1+L_2\sin(\theta_1+\theta_2).
\]

\item Orientation:
\[
\phi=\theta_1+\theta_2
\]
(since $\theta_2$ is relative to link 1).
\end{enumerate}

\subsection*{2. Pose in $\mathrm{SE}(2)$ (3 points)}

\begin{enumerate}[label=(\alph*)]
\item General pose of $E$ in frame $0$:
\[
{}^{0}\!T_{E}=
\begin{bmatrix}
\cos\phi & -\sin\phi & x\\[2pt]
\sin\phi & \ \cos\phi & y\\[2pt]
0&0&1
\end{bmatrix},\qquad \phi=\theta_1+\theta_2 .
\]

\item Compose link transforms explicitly:
\[
{}^{0}\!T_{E} = {}^{0}\!T_{1}\,{}^{1}\!T_{E},
\]
with
\[
{}^{0}\!T_{1}=
\begin{bmatrix}
\cos\theta_1 & -\sin\theta_1 & L_1\cos\theta_1\\
\sin\theta_1 & \ \cos\theta_1 & L_1\sin\theta_1\\
0&0&1
\end{bmatrix},\quad
{}^{1}\!T_{E}=
\begin{bmatrix}
\cos\theta_2 & -\sin\theta_2 & L_2\cos\theta_2\\
\sin\theta_2 & \ \cos\theta_2 & L_2\sin\theta_2\\
0&0&1
\end{bmatrix}.
\]

Multiplying,
\[
{}^{0}\!T_{E}=
\begin{bmatrix}
\cos(\theta_1+\theta_2) & -\sin(\theta_1+\theta_2) & L_2\cos(\theta_1+\theta_2)+L_1\cos\theta_1\\[2pt]
\sin(\theta_1+\theta_2) & \ \cos(\theta_1+\theta_2) & L_2\sin(\theta_1+\theta_2)+L_1\sin\theta_1\\[2pt]
0&0&1
\end{bmatrix}.
\]

\item Extract the end-effector point explicitly:
\[
p_E^{\,0} = {}^{0}\!T_{E}\,p_E^{\,E},
\qquad
p_E^{\,E}=\begin{bmatrix}0\\0\\1\end{bmatrix}
\;\Rightarrow\;
p_E^{\,0}=\begin{bmatrix}x\\y\\1\end{bmatrix}.
\]
\end{enumerate}

\subsection*{3. Numeric evaluation (2 points)}

For $\theta_1=30^\circ=\pi/6$, $\theta_2=60^\circ=\pi/3$, $L_1=1.0$, $L_2=0.8$:

\[
\phi=\theta_1+\theta_2=\tfrac{\pi}{2},\qquad
x=0.8\cos\tfrac{\pi}{2}+1\cos\tfrac{\pi}{6}=0.866,\qquad
y=0.8\sin\tfrac{\pi}{2}+1\sin\tfrac{\pi}{6}=1.300.
\]

\[
{}^{0}\!T_{E}=
\begin{bmatrix}
0 & -1 & 0.866\\
1 & 0 & 1.300\\
0 & 0 & 1
\end{bmatrix}.
\]

\subsection*{4. Tool offset (gripper) (1 point)}

Offset $d_g=0.10$ along $x_E$:

\[
{}^{E}\!T_{G}=
\begin{bmatrix}
1&0&d_g\\
0&1&0\\
0&0&1
\end{bmatrix},
\qquad
{}^{0}\!T_{G} = {}^{0}\!T_{E}\,{}^{E}\!T_{G}
=
\begin{bmatrix}
\cos\phi & -\sin\phi & x+d_g\cos\phi\\
\sin\phi & \ \cos\phi & y+d_g\sin\phi\\
0&0&1
\end{bmatrix}.
\]

Numerically,
\[
(x_G,y_G)=(0.866,1.400).
\]


\section*{Problem 4: Inverse Kinematics (2R Planar Arm)}

\subsection*{1. Reachability condition (2 points)}
Let $r=\sqrt{x^2+y^2}$. The point $(x,y)$ is reachable if:
\[
\boxed{|L_1-L_2|\le r\le L_1+L_2},
\]
i.e., the target lies in the annulus between the inner (arm folded) and outer (arm stretched) circles.

\subsection*{2. Elbow angle $\theta_2$ (3 points)}
Law of cosines on triangle $(L_1,L_2,r)$ with elbow interior angle $\pi-\theta_2$:
\[
\cos\theta_2=\frac{r^2-L_1^2-L_2^2}{2L_1L_2}=:c_2,\qquad
s_2=\pm\sqrt{1-c_2^2},\qquad
\boxed{\ \theta_2=\mathrm{atan2}(s_2,c_2)\ }.
\]
Two branches: \emph{elbow-up} ($s_2>0$) and \emph{elbow-down} ($s_2<0$).

\subsection*{3. Shoulder angle $\theta_1$ (3 points)}
Let $\alpha=\mathrm{atan2}(y,x)$ and $\beta=\mathrm{atan2}\!\big(L_2 s_2,\ L_1+L_2 c_2\big)$. Then
\[
\boxed{\ \theta_1=\alpha-\beta
= \mathrm{atan2}(y,x)-\mathrm{atan2}\!\big(L_2 s_2,\ L_1+L_2 c_2\big)\ }.
\]
This yields one $\theta_1$ for each choice of $\mathrm{sign}(s_2)$.

\subsection*{4. Numeric test \& joint limits (2 points)}
Target $(x^\star,y^\star)=(1.200,0.400)$, $L_1=1.0$, $L_2=0.8$.
Limits: $\theta_1\in[-\pi,\pi)$, $\theta_2\in[-3\pi/4,3\pi/4]=[-2.356,2.356]$.

\paragraph{Step 1: $r$, $c_2$, $s_2$ (3 d.p.).}
\[
r^2 = 1.200^2+0.400^2 = 1.600,\qquad r=\sqrt{1.600}= \boxed{1.265}.
\]
\[
c_2=\frac{r^2-L_1^2-L_2^2}{2L_1L_2}
=\frac{1.600-1.000-0.640}{2(1.0)(0.8)}
=\frac{-0.040}{1.600}= \boxed{-0.025},
\]
\[
s_2=\pm\sqrt{1-c_2^2}= \pm\sqrt{1-0.025^2}= \boxed{\pm 0.999}.
\]

\paragraph{Step 2: $\alpha$ and $\beta$ (3 d.p.).}
\[
\alpha=\atan2(0.400,1.200)=\atan(1/3)= \boxed{0.322}\ \text{rad},
\]
\[
L_1+L_2c_2=1.0+0.8(-0.025)=0.980,\quad L_2s_2=0.8\times 0.999=0.800.
\]
\[
\beta_{\pm}=\atan2(\pm 0.800,\,0.980)= \boxed{\pm 0.684}\ \text{rad}.
\]

\paragraph{Step 3: Joint angles (3 d.p.).}
\[
\theta_2=\atan2(s_2,c_2)=
\begin{cases}
\boxed{+1.596} & (s_2>0,\ \text{elbow-up}),\\
\boxed{-1.596} & (s_2<0,\ \text{elbow-down}),
\end{cases}
\qquad
\theta_1=\alpha-\beta_{\pm}=
\begin{cases}
\boxed{-0.363} & (\text{elbow-up}),\\
\boxed{+1.006} & (\text{elbow-down}).
\end{cases}
\]

\paragraph{Step 4: Joint-limit check.}
\[
-2.356\le \pm 1.596 \le 2.356,\qquad -\pi< -0.363,\ 1.006 < \pi.
\]
\[
\boxed{(-0.363,\ +1.596)}\ \text{and}\ \boxed{(1.006,\ -1.596)}\ \text{both satisfy the limits.}
\]

\paragraph{Step 5: Forward check (using the rounded angles).}
\[
\hat x=L_1\cos\theta_1+L_2\cos(\theta_1+\theta_2),\quad
\hat y=L_1\sin\theta_1+L_2\sin(\theta_1+\theta_2).
\]

\emph{Elbow-up} $(\theta_1,\theta_2)=(-0.363,\,1.596)$:
\[
\cos\theta_1\approx 0.935,\ \sin\theta_1\approx -0.355,\ 
\cos(\theta_1+\theta_2)=\cos(1.233)\approx 0.332,\ 
\sin(1.233)\approx 0.944.
\]
\[
\hat x=1(0.935)+0.8(0.332)=\underline{1.201}\approx 1.200,\quad
\hat y=1(-0.355)+0.8(0.944)=\underline{0.400}\ (\le 10^{-3}\ \text{from }y^\star).
\]

\emph{Elbow-down} $(\theta_1,\theta_2)=(1.006,\,-1.596)$:
\[
\cos\theta_1\approx 0.535,\ \sin\theta_1\approx 0.845,\ 
\cos(\theta_1+\theta_2)=\cos(-0.590)\approx 0.831,\ 
\sin(-0.590)\approx -0.556.
\]
\[
\hat x=1(0.535)+0.8(0.831)=\underline{1.200},\quad
\hat y=1(0.845)+0.8(-0.556)=\underline{0.400}.
\]
In both branches, $\|(\hat x,\hat y)-(x^\star,y^\star)\|\le 10^{-3}$.

\subsection*{4.4 Numerical IK Computation}

The following Python script implements the inverse kinematics computation for Problem 4:

\begin{lstlisting}[caption={Python Implementation of 2R Planar Arm Inverse Kinematics}]
import math

L1, L2 = 1.0, 0.8
x, y = 1.20, 0.40

r = math.hypot(x, y)
c = (r*r - L1*L1 - L2*L2) / (2*L1*L2)
s = math.sqrt(1 - c*c)

theta2_down = math.atan2(+s, c)
theta2_up   = math.atan2(-s, c)

a_down = L1 + L2*math.cos(theta2_down)
b_down = L2*math.sin(theta2_down)
theta1_down = math.atan2(y, x) - math.atan2(b_down, a_down)

a_up = L1 + L2*math.cos(theta2_up)
b_up = L2*math.sin(theta2_up)
theta1_up = math.atan2(y, x) - math.atan2(b_up, a_up)

print(f"Elbow-down: theta1={theta1_down:.3f}, theta2={theta2_down:.3f}")
print(f"Elbow-up:   theta1={theta1_up:.3f}, theta2={theta2_up:.3f}")

xd = L1*math.cos(theta1_down) + L2*math.cos(theta1_down + 
     theta2_down)
yd = L1*math.sin(theta1_down) + L2*math.sin(theta1_down + 
     theta2_down)
xu = L1*math.cos(theta1_up)   + L2*math.cos(theta1_up   + theta2_up)
yu = L1*math.sin(theta1_up)   + L2*math.sin(theta1_up   + theta2_up)

print(f"Forward check: down = ({xd:.3f}, {yd:.3f})")
print(f"Forward check: up   = ({xu:.3f}, {yu:.3f})")
\end{lstlisting}

\textbf{Output:}
\begin{verbatim}
Elbow-down: theta1=-0.363, theta2=1.596
Elbow-up:   theta1=1.006, theta2=-1.596
Forward check: down = (1.200, 0.400)
Forward check: up   = (1.200, 0.400)
\end{verbatim}

\end{document}